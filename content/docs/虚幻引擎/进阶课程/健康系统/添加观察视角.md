---
title: "添加观察视角"
date: 2023-06-11T05:51:30
lastmod: 2023-08-07T15:11:52+08:00
draft: false
weight: 1006
---

## 说明 {#说明}

当游戏角色生命值为0，我们尝试剥夺玩家对游戏角色的控制，此时仍能旋转Camera; 左右旋转视角时, Character身体也会旋转 <br/>

我们可以在游戏角色死亡时，切换玩家控制的Pawn：一方面，彻底剥夺玩家对游戏角色的控制，另一方面，允许玩家做合理的操作 <br/>


### 观察视角 {#观察视角}

-   对应一个APawn派生类，ASpectatorPawn <br/>
-   关卡的默认类型里，观察者类使用ASpectatorPawn <br/>
-   玩家死亡后，使其操控SpectatorPawn，仍能继续观看游戏 <br/>


### 场景中的SpectatorPawn {#场景中的spectatorpawn}

漂浮的Camera，除了可以前后左右移动，还可以上下移动，亦支持旋转，由鼠标控制 <br/>


### 本小节使用默认的观察者类 {#本小节使用默认的观察者类}


## 游戏角色死亡后，切换到观察视角 {#游戏角色死亡后-切换到观察视角}

`C++` <br/>

先前我们已设置STUGameModeBase使用STUPlayerController类。 <br/>

APawn::Controller和具体的Controller对象动态绑定。由于其声明里使用AController，所以我们包含AController的头文件而非STUPlayerController的。 <br/>

游戏角色死亡时，切换到观察视角 <br/>
`ShootThemUp: Player/STUBaseCharacter.cpp` <br/>

```cpp
#include "GameFramework/Controller.h"

// OnDeath
if (Controller)
{
    Controller->ChangeState(NAME_Spectating);
}
```


## 查看 {#查看}

`虚幻编辑器` <br/>


### 查看SpectatorPawn {#查看spectatorpawn}

1.  WorldSetting中，GameMode默认选择SpectatorPawn作为Spectator Class <br/>
    
    <img src="/pic/健康系统/实现观察视角/在编辑器中查看观察视角/WorldSetting-SpectatorClass.png" width="400" /> <br/> <br/>
2.  Pawn也可选择SpectatorPawn <br/>
    
    <img src="/pic/健康系统/实现观察视角/在编辑器中查看观察视角/WorldSetting-为Pawn选择SpectatorPawn.png" width="400" /> <br/> <br/>


### 验证观察视角 {#验证观察视角}

Character死亡后，世界大纲新增SpectatorPawn1 <br/>

<img src="/pic/健康系统/实现观察视角/在编辑器中查看观察视角/Outliner-SpectatorPawn1.png" width="1000" /> <br/> <br/>

