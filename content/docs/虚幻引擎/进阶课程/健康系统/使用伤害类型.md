---
title: "使用伤害类型"
date: 2023-06-11T05:50:41
lastmod: 2023-08-07T10:17:00+08:00
draft: false
weight: 1004
---

## 创建伤害类型 {#创建伤害类型}

`虚幻编辑器` <br/>


### 创建Dev/STUFireDamageType {#创建dev-stufiredamagetype}

-   `UDamageType` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/创建UDamageType的派生类/基类DamageType.png" width="700" /> <br/> <br/>
-   `公有类` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/创建UDamageType的派生类/STUFireDamageType.png" width="700" /> <br/> <br/>


### 创建Dev/STUIceDamageType {#创建dev-stuicedamagetype}

-   `UDamageType` <br/>
-   `公有类` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/创建UDamageType的派生类/STUIceDamageType.png" width="700" /> <br/> <br/>


## 为伤害来源添加伤害类型属性 {#为伤害来源添加伤害类型属性}

`C++` <br/>

1.  添加伤害类型参数 <br/>
    `protected` <br/>
    `ShootThemUp: Dev/STUDevDamageActor.h` <br/>
    ```cpp
    UPROPERTY(EditAnywhere)
    TSubclassOf<UDamageType> DamageType;
    ```
2.  造成伤害时，传入伤害类型 <br/>
    `ShootThemUp: Dev/STUDevDamageActor.cpp` <br/>
    ```cpp
    // Tick
    // UGameplayStatics::ApplyRadialDamage(GetWorld(), Damage, GetActorLocation(), Radius, nullptr, {}, this, nullptr, DoFullDamage);
    UGameplayStatics::ApplyRadialDamage(GetWorld(), Damage, GetActorLocation(), Radius, DamageType, {}, this, nullptr, DoFullDamage);
    ```


## 在伤害处理函数中输出伤害来源信息 {#在伤害处理函数中输出伤害来源信息}

`C++` <br/>
`ShootThemUp: Components/STUHealthComponent.cpp` <br/>

```cpp
#include "Dev/STUFireDamageType.h"
#include "Dev/STUIceDamageType.h"

// OnTakeAnyDamage
if (DamageType)
{
    if (DamageType->IsA<USTUFireDamageType>())
    {
        UE_LOG(LogHealthComponent, Display, TEXT("So Hooooooot !!!"));
    }
    else if (DamageType->IsA<USTUIceDamageType>())
    {
        UE_LOG(LogHealthComponent, Display, TEXT("So Cooooooooold !!!"));
    }
}
```


## 查看 {#查看}

`虚幻编辑器` <br/>


### 为伤害来源设置DamageType属性 {#为伤害来源设置damagetype属性}

1.  `DamageSphere-Red` 选择 `STUFireDamageType` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/查看UDamageType生效/设置Red.png" width="400" /> <br/> <br/>
2.  `DamageSphere-Blue` 选择 `STUIceDamageType` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/查看UDamageType生效/设置Blue.png" width="400" /> <br/> <br/>


### 查看日志 {#查看日志}

1.  游戏角色进入到 `DamageSphere-Red` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/查看UDamageType生效/Red日志.png" width="800" /> <br/> <br/>
2.  游戏角色进入到 `DamageSphere-Blue` <br/>
    
    <img src="/pic/健康系统/使用伤害类型/查看UDamageType生效/Blue日志.png" width="800" /> <br/> <br/>

