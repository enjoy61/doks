---
title: "装备武器标志位"
date: 2023-08-28T21:22:13
lastmod: 2023-08-28T21:22:33+08:00
draft: false
weight: 2018
---

## 说明 {#说明}

添加标志位, 播放装备武器动画时置为true, 播放结束置为false <br/>


## 概览 {#概览}

-   [X] 装备武器动画播放结束之前, 不允许切换武器 <br/>
-   [X] 装备武器动画播放结束之前, 不允许射击 <br/>


## 装备武器标志位 {#装备武器标志位}


### 定义 {#定义}

`private` <br/>
`ShootThemUp: Components/STUWeaponComponent.h` <br/>

```cpp
bool EquipAnimInProgress = false;
```


### 设置 {#设置}

`ShootThemUp: Components/STUWeaponComponent.cpp` <br/>

```cpp
//EquipWeapon
EquipAnimInProgress = true;

// OnEquipFinished
EquipAnimInProgress = false;
```


## 添加接口: 允许更换武器 {#添加接口-允许更换武器}


### 定义 {#定义}

-   `ShootThemUp: Components/STUWeaponComponent.h` <br/>
    ```cpp
    bool CanEquip() const;
    ```
-   `ShootThemUp: Components/STUWeaponComponent.cpp` <br/>
    ```cpp
    bool USTUWeaponComponent::CanFire() const { return (CurrentWeapon && !EquipAnimInProgress); }
    ```


### 调用 {#调用}

`ShootThemUp: Components/STUWeaponComponent.cpp` <br/>

```cpp
// NextWeapon
if (!CanEquip()) return;
```


## 添加接口: 允许射击 {#添加接口-允许射击}


### 定义 {#定义}

-   `ShootThemUp: Components/STUWeaponComponent.h` <br/>
    `private` <br/>
    ```cpp
    bool CanFire() const;
    ```
-   `ShootThemUp: Components/STUWeaponComponent.cpp` <br/>
    ```cpp
    bool USTUWeaponComponent::CanEquip() const { return !EquipAnimInProgress; }
    ```


### 调用 {#调用}

`ShootThemUp: Components/STUWeaponComponent.cpp` <br/>

```cpp
// FireStart
if (!CanFire()) return;
```

