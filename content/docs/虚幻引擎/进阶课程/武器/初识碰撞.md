---
title: "初识碰撞"
date: 2023-06-25T16:56:18
lastmod: 2023-08-17T18:06:53+08:00
draft: false
weight: 1005
---

## 概览 {#概览}

`虚幻编辑器` <br/>

-   [X] 在虚幻编辑器使用控制台 `Console` <br/>
-   [X] 碰撞选项 <br/>


## 碰撞 {#碰撞}

碰撞是物体之间的交互，会发生以下情形 <br/>

| -       |            |
|---------|------------|
| Ignore  | 忽略       |
| Overlap | 重叠: 产生重叠事件 |
| Block   | 阻挡：产生碰撞事件 |

游戏角色拥有Capsule组件, 用以处理碰撞相关逻辑: 如游戏角色跳起后会落到地面, 而不是穿过地板; 可以操控其上楼梯; 和另一个游戏角色碰撞, 而不是穿过他 <br/>


## 轨迹计算 {#轨迹计算}

`Logical Trace` <br/>
给定轨迹的端点A和B, 计算场景中与轨迹相交的物体 <br/>

通过轨迹计算得到射击击中的目标 <br/>


## 在虚幻编辑器使用控制台 {#在虚幻编辑器使用控制台}

1.  打开控制台 <br/>
    运行时, 按下 \` `Apostrophe Sign` , 在视口下方会出现命令行, 可以输入调试命令 <br/>
2.  设置打开控制台的快捷键 <br/>
    `项目设置 > Engine > Input > Console > Console Keys` <br/>


### 输出每秒帧数 {#输出每秒帧数}

```text
stat fps
```

1.  在右上方显示 <br/>
    
    <img src="/pic/武器/初识碰撞/fps.png" width="800" /> <br/> <br/>
2.  1秒将近40帧 <br/>
    ```text
    1s / 25ms = 1000ms / 25ms = 40
    ```


### 输出GPU统计数据 {#输出gpu统计数据}

```text
stat GPU    
```

<img src="/pic/武器/初识碰撞/gpu.png" width="800" /> <br/> <br/>


### 隐藏Debug信息 {#隐藏debug信息}

输入相同命令, 或 <br/>

```text
stat none
```


### 显示场景中的碰撞 {#显示场景中的碰撞}

```text
show collision    
```

1.  可以看到Character的Capsule组件；碰撞组件纯逻辑, 在游戏中默认不可见 <br/>
    
    <img src="/pic/武器/初识碰撞/show-collision.png" width="800" /> <br/> <br/>
2.  再次输入隐藏 <br/>


## 碰撞选项 {#碰撞选项}

[碰撞选项](/docs/虚幻引擎/专题/虚幻编辑器/碰撞选项/#碰撞选项) <br/>
在场景中添加Cube和Sphere `Place Actors > Shapes`      <br/>


## 设置游戏角色穿过物体 {#设置游戏角色穿过物体}

在场景中添加Sphere和Cube `Place Actors > Shapes` <br/>


### 设置游戏角色Capsule组件的碰撞选项 {#设置游戏角色capsule组件的碰撞选项}

`BP_STUBaseCharacter > Capsule Component > Details > Collision` <br/>

1.  碰撞预设默认为Pawn <br/>
    
    <img src="/pic/武器/初识碰撞/capsule-default.png" width="400" /> <br/> <br/>
2.  将碰撞预设置为Custom <br/>


### 设置Sphere的碰撞选项 {#设置sphere的碰撞选项}

1.  将碰撞预设设置为Custom <br/>
2.  允许游戏角色穿过 <br/>
    对物体类型的碰撞反馈中, 设置对Pawn执行Overlap `Collision Responses > Object Responses > Pawn, 勾选Overlap` <br/>
    
    <img src="/pic/武器/初识碰撞/sphere-pawn-overlap.png" width="450" /> <br/> <br/>


### 设置Cube的碰撞选项 {#设置cube的碰撞选项}

1.  设置 `Collision Preset` 为Custom <br/>
2.  允许Pawn穿过 <br/>
    
    <img src="/pic/武器/初识碰撞/cube-pawn-overlap.png" width="450" /> <br/> <br/>


### 查看 {#查看}


#### 游戏角色可以穿过Sphere和Cube {#游戏角色可以穿过sphere和cube}


#### 游戏角色与物体碰撞时, 镜头会放大, 这是因为Camera通道的碰撞反馈为Block {#游戏角色与物体碰撞时-镜头会放大-这是因为camera通道的碰撞反馈为block}

-   可以在SpringArm组件设置碰撞探测通道, 默认使用Camera通道 <br/>
-   Camera组件作为SpringArm组件的下级组件, 是游戏角色的一部分, 此时也与Sphere碰撞 <br/>
-   之所以会放大镜头, 在于发生碰撞时要表示阻挡; 我们不应该看到已经穿过物体那部分 <br/>


## 设置Camera通道忽略物体 {#设置camera通道忽略物体}


### 查看SpringArm组件 {#查看springarm组件}

`BP_STUBaseCharacter > 选中SpringArmComponent > Details > Camera Collision > Probe Channel` <br/>
SpringArm组件如何进行碰撞探测, 默认为Camera通道 <br/>

| Probe Channel |
|---------------|
| Camera        |


### 设置Camera通道忽略Sphere {#设置camera通道忽略sphere}

`Collision Responses > Trace Responses > Camera, 选择Ignore` <br/>

<img src="/pic/武器/初识碰撞/Sphere-TraceResponses-Camera-Ignore.png" width="450" /> <br/> <br/>


### 查看: 游戏角色穿过Sphere时, 感官上正常 {#查看-游戏角色穿过sphere时-感官上正常}


## 产生重叠事件: 输出Actor信息 {#产生重叠事件-输出actor信息}


### 在蓝图中处理事件 {#在蓝图中处理事件}

1.  打开BP_STUBaseCharacter &gt; Event Graph <br/>
2.  在 `Event ActorBeginOverlap` 之后, 在屏幕打印 `PrintString` <br/>
3.  OtherActor作为PrintString输入, 实际输出产生碰撞的物体名称 <br/>

<img src="/pic/武器/初识碰撞/Overlap-PrintString.png" width="1000" /> <br/> <br/>


### 为物体勾选产生重叠事件 {#为物体勾选产生重叠事件}

1.  Sphere <br/>
    `Details > 勾选 Generate Overlap Events` <br/>
    
    <img src="/pic/武器/初识碰撞/Sphere-Gen-Overlap.png" width="400" /> <br/> <br/>
2.  Cube <br/>
    `Details > 勾选 Generate Overlap Events` <br/>


### 查看日志 {#查看日志}

<img src="/pic/武器/初识碰撞/Overlap-Log.png" width="500" /> <br/> <br/>


## 产生碰撞事件: 获取碰撞信息 {#产生碰撞事件-获取碰撞信息}


### 为物体勾选产生碰撞事件 {#为物体勾选产生碰撞事件}

选择Cube, 去到Details面板, 勾选 `Simulation Generates Hit Events` <br/>

<img src="/pic/武器/初识碰撞/cube-hit-event.png" width="450" /> <br/> <br/>


### 在蓝图中添加事件 {#在蓝图中添加事件}

`BP_STUBaseCharacter > EventGraph, 添加EventHit` <br/>


## 自定义物体类型 {#自定义物体类型}

`项目设置 > Engine > Collision` <br/>


### 创建物体类型Enemy {#创建物体类型enemy}

1.  `New Object Channel` <br/>
    
    <img src="/pic/武器/初识碰撞/新建物体类型1.png" width="800" /> <br/> <br/>
2.  设置 <br/>
    
    | -                |       |
    |------------------|-------|
    | Name             | Enemy |
    | Default Response | Block |
    
    <img src="/pic/武器/初识碰撞/Enemy.png" width="250" /> <br/> <br/>
3.  其他类型物体对Enemy采取Block <br/>


### 创建物体类型Geometry {#创建物体类型geometry}

1.  `New Object Channel` <br/>
2.  设置 <br/>
    
    | -                |          |
    |------------------|----------|
    | Name             | Geometry |
    | Default Response | Ignore   |
    
    <img src="/pic/武器/初识碰撞/Geometry.png" width="250" /> <br/> <br/>
3.  其他类型物体对Geometry采取Ignore <br/>


### 查看游戏角色的碰撞选项 {#查看游戏角色的碰撞选项}

| -        |        |
|----------|--------|
| Enemy    | Block  |
| Geometry | Ignore |

<img src="/pic/武器/初识碰撞/CharacterToEnemyAndGeometry.png" width="1000" /> <br/> <br/>


### 设置Cube {#设置cube}

1.  物体类型为Geometry <br/>
2.  忽略Pawn <br/>

<img src="/pic/武器/初识碰撞/Cube-Geometry.png" width="400" /> <br/>    <br/>


### 设置Sphere {#设置sphere}

1.  物体类型为Enemy <br/>
2.  阻挡Pawn <br/>

<img src="/pic/武器/初识碰撞/Sphere-Enemy.png" width="400" /> <br/>            <br/>


## 查看碰撞预设定义 {#查看碰撞预设定义}

可以自定义预设规则, 如A类型物体对其他类型物体如何作出反应; 或者修改已有预设 <br/>

<img src="/pic/武器/初识碰撞/CollisionPreset.png" width="1000" /> <br/> <br/>

