---
title: "初识碰撞"
date: 2023-06-25T16:56:18
lastmod: 2023-08-12T14:37:03+08:00
draft: false
weight: 1005
---

## 说明 {#说明}

`虚幻编辑器` <br/>


## 了解碰撞 {#了解碰撞}

1.  碰撞 <br/>
    -   碰撞是世界中物体的物理交互 <br/>
    -   如Character的Capsule组件, 因为它的存在, 我们跳起后会落到地面, 而不是穿过地板; 我们可以上楼梯, 或是和另一个Character碰撞(而不是穿过他) <br/>
2.  Logical Trace <br/>
    -   一条轨迹, 给定端点A和B, 计算与轨迹相交的场景中的物体 <br/>
    -   射击时通过该判断, 得到击中目标 <br/>


## 在虚幻编辑器使用Console {#在虚幻编辑器使用console}

1.  鼠标已由程序控制, 打开Console <br/>
    按下 \` (apostrophe sign), 在视口下方会出现命令行, 可以输入debug命令 <br/>
2.  设置打开Console的快捷键 <br/>
    `项目设置 > Engine > Input > Console > Console Keys` <br/>


### 输出每秒帧数 {#输出每秒帧数}

```text
stat fps
```

在右上方角落显示, 一秒将近40帧, 40 x 25 ms = 1000 ms = 1 s <br/>

<img src="/pic/武器/初识碰撞/fps.png" width="800" /> <br/> <br/>


### 输出GPU统计数据 {#输出gpu统计数据}

```text
stat GPU    
```

<img src="/pic/武器/初识碰撞/gpu.png" width="800" /> <br/> <br/>


### 隐藏debug信息 {#隐藏debug信息}

输入相同命令, 或 <br/>

```text
stat none
```


### 显示场景中碰撞相关 {#显示场景中碰撞相关}

```text
show collision    
```

-   可以看到Character的Capsule组件. 这很方便, 因为碰撞组件纯逻辑, 在游戏中默认不可见 <br/>
    
    <img src="/pic/武器/初识碰撞/show-collision.png" width="800" /> <br/> <br/>
-   再次输入show collision关闭 <br/>


## 碰撞选项 {#碰撞选项}

1.  往场景中添加Cube和Sphere <br/>
    `Place Actors > Shapes` <br/>
2.  [碰撞选项](/docs/虚幻引擎/专题/虚幻编辑器/碰撞选项/#碰撞选项) <br/>


## 设置Character碰撞选项 {#设置character碰撞选项}


### 设置CapsuleComponent的碰撞选项 {#设置capsulecomponent的碰撞选项}

`BP_STUBaseCharacter > Capsule Component > Details > Collision` <br/>

1.  碰撞预设默认为Pawn <br/>
    
    <img src="/pic/武器/初识碰撞/capsule-default.png" width="500" /> <br/> <br/>
2.  将碰撞预设置为Custom <br/>


### 设置Sphere的碰撞选项 {#设置sphere的碰撞选项}

1.  碰撞预设选择Custom <br/>
2.  允许游戏角色Overlap <br/>
    
    <img src="/pic/武器/初识碰撞/sphere-pawn-overlap.png" width="450" /> <br/> <br/>
3.  Character不可通过Cube, 但可通过Sphere <br/>
4.  Charater与Sphere重叠时, CameraComponent会有交叉反应-放大镜头, 因为CameraComponent处于Character中间, 这是由SpringArm造成的 <br/>


### 查看SpringArm组件 {#查看springarm组件}

`BP_STUBaseCharacter > 选中SpringArmComponent > Details > Camera Collision > Probe Channel` <br/>
SpringArm组件需要知道如何与世界进行物理交互 <br/>

| Probe Channel |
|---------------|
| Camera        |

我们可以修改 `Sphere > Collision Responses > Trace Responses > Camera` , 使得Character穿过Sphere时, CameraComponent忽略该事件 <br/>


### 再次设置Sphere {#再次设置sphere}

`Collision Responses > Trace Responses > Camera, 选择Ignore` <br/>

<img src="/pic/武器/初识碰撞/Sphere-TraceResponses-Camera-Ignore.png" width="450" /> <br/> <br/>

-   之所以需要设置SpringArm的碰撞,因为当我们穿过墙时, 我们不应该可以看到墙的原先那一面 <br/>
-   现在我们穿过Sphere, 感官上正常 <br/>


## 重叠事件: 输出Actor信息 {#重叠事件-输出actor信息}


### 设置事件 {#设置事件}

1.  打开BP_STUBaseCharacter &gt; Event Graph <br/>
2.  在 `Event ActorBeginOverlap` 之后, 执行PrintString(在屏幕打印) <br/>
3.  OtherActor作为PrintString输入, 实际输出产生碰撞的物体名称 <br/>

<img src="/pic/武器/初识碰撞/Overlap-PrintString.png" width="1000" /> <br/> <br/>


### 为Sphere设置产生重叠事件 {#为sphere设置产生重叠事件}

1.  `Sphere > Details > 勾选 Generate Overlap Events` <br/>
    
    <img src="/pic/武器/初识碰撞/Sphere-Gen-Overlap.png" width="400" /> <br/> <br/>
    
    出于优化考虑, 默认false <br/>
2.  日志 <br/>
    
    <img src="/pic/武器/初识碰撞/Sphere-Overlap-Log.png" width="500" /> <br/> <br/>


## 碰撞事件: 获取碰撞信息 {#碰撞事件-获取碰撞信息}


### 设置Cube {#设置cube}

1.  设置Collision Preset为Custom <br/>
2.  勾选产生重叠事件 <br/>
    `Generate Overlap Events` <br/>
3.  允许Pawn重叠 <br/>
    
    <img src="/pic/武器/初识碰撞/cube-pawn-overlap.png" width="450" /> <br/> <br/>


### 获取碰撞信息 {#获取碰撞信息}

1.  选择Cube, 勾选 `Simulation Generates Hit Events` <br/>
    
    <img src="/pic/武器/初识碰撞/cube-hit-event.png" width="450" /> <br/> <br/>
2.  `BP_STUBaseCharacter > EventGraph, 添加EventHit` <br/>


## 自定义碰撞相关 {#自定义碰撞相关}

`项目设置 > Engine > Collision` <br/>

| -               |      |
|-----------------|------|
| Object Channels | 物体类型 |
| Trace Channels  |      |
| Preset          | 预设 |


### 自定义物体类型 {#自定义物体类型}

`Object Channels` <br/>


#### 创建物体类型Enemy {#创建物体类型enemy}

1.  `点击New Object Channel` <br/>
    
    <img src="/pic/武器/初识碰撞/新建物体类型1.png" width="800" /> <br/> <br/>
2.  命名为Enemy, Default Response为Block <br/>
    
    <img src="/pic/武器/初识碰撞/Enemy.png" width="250" /> <br/> <br/>


#### 创建物体类型Geometry {#创建物体类型geometry}

1.  `点击New Object Channel, 命名为Geometry` <br/>
2.  设置Default Response为Ignore <br/>
    
    <img src="/pic/武器/初识碰撞/Geometry.png" width="250" /> <br/> <br/>
    
    其他类型自动忽略Geometry物体 <br/>


#### 查看Character对Geometry和Enemy的反馈 {#查看character对geometry和enemy的反馈}

| -        |        |
|----------|--------|
| Enemy    | Block  |
| Geometry | Ignore |

<img src="/pic/武器/初识碰撞/CharacterToEnemyAndGeometry.png" width="1000" /> <br/> <br/>


#### 设置Cube {#设置cube}

1.  物体类型为Geometry <br/>
2.  忽略Pawn <br/>

<img src="/pic/武器/初识碰撞/Cube-Geometry.png" width="400" /> <br/>    <br/>


#### 设置Sphere {#设置sphere}

1.  物体类型为Enemy <br/>
2.  阻挡Pawn <br/>

<img src="/pic/武器/初识碰撞/Sphere-Enemy.png" width="400" /> <br/>            <br/>


### 预设 {#预设}

可以自定义预设规则, 如A类型物体对其他类型物体如何作出反应; 或者修改已有预设 <br/>

<img src="/pic/武器/初识碰撞/CollisionPreset.png" width="1000" /> <br/> <br/>

