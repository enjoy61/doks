---
title: "补给基类、生命补给和弹药补给"
date: 2023-10-11T12:15:48
lastmod: 2023-10-11T12:21:42+08:00
draft: false
weight: 2002
---

## 为地板和楼梯添加材质 {#为地板和楼梯添加材质}


### 从ShooterGame导出材质 {#从shootergame导出材质}

`Content/Environment/Materials` <br/>

| -                   |    |
|---------------------|----|
| M_FFA_Floor_02_Dark | 地板 |
| M_FFA_Wall_04       | 楼梯 |

<img src="/pic/补给/补给基类、生命补给和弹药补给/floor-stair.png" width="800" /> <br/> <br/>

导出 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/migrate.png" width="1000" /> <br/> <br/>

相关资产 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/assets.png" width="600" /> <br/> <br/>


### 导入到ShootThemUp {#导入到shootthemup}

创建文件夹 `Content/ExternalContent/Pickup` , 保存到此处 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/pickups.png" width="300" /> <br/> <br/>


### 设置地板 {#设置地板}

-   应用材质 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/floor-material.png" width="400" /> <br/> <br/>
-   设置变换 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/floor-scale.png" width="400" /> <br/> <br/>


### 设置楼梯 {#设置楼梯}

-   移除楼梯 <br/>
-   添加楼梯 <br/>
    `Place Actors > Geometry > Box` <br/>
-   设置纹理 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/stair-material.png" width="400" /> <br/> <br/>
-   设置变换 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/stair-scale.png" width="400" /> <br/> <br/>
-   设置规格 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/stair-brush.png" width="400" /> <br/> <br/>
-   一共四级台阶 <br/>
    按下Option键, 延Z轴拖动台阶; Z方向按80递增, X方向按250递增 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/stairs.png" width="800" /> <br/> <br/>


## 创建所需静态网格体和材质 {#创建所需静态网格体和材质}


### 创建材质类 {#创建材质类}

`Content/Materials` <br/>
创建材质, 命名为M_BaseGlow <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/create-material.png" width="600" /> <br/> <br/>

两个参数: Color和Glow <br/>
发光参数默认值设为10 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/M_BaseGlow.png" width="800" /> <br/> <br/>

创建材质实例 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/create-mi.png" width="600" /> <br/> <br/>

MI_BlueGlow <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/mi-blue.png" width="600" /> <br/> <br/>

MI_GreenGlow <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/mi-green.png" width="600" /> <br/> <br/>

如图 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/new-create-m-mi.png" width="800" /> <br/> <br/>


### 创建静态网格体 {#创建静态网格体}

新建文件夹 `Content/Pickups/StaticMeshes` <br/>


#### 创建生命补给 {#创建生命补给}

-   `Place Actors > Geometry > Box` , 添加 <br/>
-   设置 `Details > Brush Settings` , X = 40, Y = 80, Z = 40 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/health-set.png" width="500" /> <br/> <br/>
-   按下E, 切换到旋转模式 <br/>
-   按下Option, 绕X轴旋转90渡 <br/>
-   按下Command, 选中两个笔刷 `Brush` , `Details > Brush Settings > Create Static Mesh` <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/create-static-mesh-health.png" width="1000" /> <br/> <br/>
-   保存到 `Content/Pickups/StaticMeshes` , 命名为S_Health <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/sm-health.png" width="400" /> <br/> <br/>
-   双击打开, 应用材质 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/sm-health-m.png" width="1200" /> <br/> <br/>


#### 创建弹药补给 {#创建弹药补给}

-   `Place Actors > Geometry > Cylinder` , 添加 <br/>
    设置基准 `Transform > Location` : X = 1000, Y = 2000, Z = 50 <br/>
    圆柱有三个参数, 高度, 半径和分片 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/cylinder1.png" width="800" /> <br/> <br/>
-   按下Option, 向上拖动, 设置参数 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/cylinder2.png" width="800" /> <br/> <br/>
-   按下Option, 向上拖动, 设置参数 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/cylinder3.png" width="800" /> <br/> <br/>
-   `Place Actors > Geometry > Sphere` , 添加 <br/>
    球体有两个参数, 半径和细分 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/sphere.png" width="800" /> <br/> <br/>
-   按下Command, 选中三个圆柱和球体, 拖动, 二者间隔50 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/rocket-double.png" width="800" /> <br/> <br/>
-   选中6个圆柱体, 2个球体, `Details > Brush Settings > Create Static Mesh` <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/6+2.png" width="800" /> <br/> <br/>
-   命名为S_Rockets <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/s-rockets.png" width="500" /> <br/> <br/>
-   应用材质 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/s-rockets-m.png" width="1000" /> <br/> <br/>


## 创建补给类 {#创建补给类}

|                 | 基类          | 上级文件夹 | 属性   |
|-----------------|-------------|-------|------|
| STUBasePickup   | Actor         | Pickups | Public |
| STUAmmoPickup   | STUBasePickup |         |        |
| STUHealthPickup | STUBasePickup |         |        |

-   创建派生类 <br/>
    `C++ Classes > ShootThemUp > Public > Pickups > STUBasePickup` <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/create-derived.png" width="700" /> <br/> <br/>
-   添加头文件搜索路径 <br/>
    `ShootThemUp: ShootThemUp.Build.cs` <br/>
    ```cpp
    PublicIncludePaths.AddRange(new string[]
    {
        "ShootThemUp/Public/Player",
        "ShootThemUp/Public/Components",
        "ShootThemUp/Public/Dev",
        "ShootThemUp/Public/Weapon",
        "ShootThemUp/Public/UI",
        "ShootThemUp/Public/Animations",
        "ShootThemUp/Public/Pickups"
    });
    ```


## 补给基类 {#补给基类}

`STUBasePickup` <br/>
添加碰撞组件 <br/>
`ShootThemUp: Pickups/STUBasePickup.h` <br/>
`protected` <br/>

```cpp
class USphereComponent;

UPROPERTY(VisibleAnywhere)
USphereComponent *CollisionComponent;
```

触发重叠事件 <br/>
`ShootThemUp: Pickups/STUBasePickup.cpp` <br/>

```cpp
#include "Components/SphereComponent.h"

DEFINE_LOG_CATEGORY_STATIC(LogBasePickup, All, All);

// Constructor
CollisionComponent = CreateDefaultSubobject<USphereComponent>("SphereComponent");
CollisionComponent->InitSphereRadius(50.0f);
CollisionComponent->SetCollisionEnabled(ECollisionEnabled::QueryOnly);
CollisionComponent->SetCollisionResponseToAllChannels(ECollisionResponse::ECR_Overlap);    
SetRootComponent(CollisionComponent);
```

覆写NotifyActorBeginOverlap函数, 发生重叠事件时调用 <br/>
`ShootThemUp: Pickups/STUBasePickup.h` <br/>
`protected` <br/>

```cpp
virtual void NotifyActorBeginOverlap(AActor *OtherActor) override;
```

重叠后销毁Actor <br/>
`ShootThemUp: Pickups/STUBasePickup.cpp` <br/>

```cpp
void ASTUBasePickup::NotifyActorBeginOverlap(AActor *OtherActor)
{
    Super::NotifyActorBeginOverlap(OtherActor);
    UE_LOG(LogBasePickup, Display, TEXT("Pickups was taken"));
    Destroy();
}
```


## 创建蓝图类 {#创建蓝图类}

-   创建基于STUAmmoPickup和STUHealthPickup的蓝图类, 保存到 `Content/Pickups` <br/>
-   为蓝图类添加静态网格体组件, 绑定 `Content/Pickups/StaticMeshes` 下的静态网格体 <br/>
    
    <img src="/pic/补给/补给基类、生命补给和弹药补给/add-sm.png" width="300" /> <br/> <br/>

弹药补给 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/ammo.png" width="1000" /> <br/> <br/>

生命补给 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/health.png" width="1000" /> <br/> <br/>


## 查看 {#查看}

<img src="/pic/补给/补给基类、生命补给和弹药补给/result1.png" width="1000" /> <br/> <br/>

日志 <br/>

<img src="/pic/补给/补给基类、生命补给和弹药补给/日志.png" width="1000" /> <br/> <br/>

