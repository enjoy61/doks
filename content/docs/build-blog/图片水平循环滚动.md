---
title: "图片水平循环滚动"
date: 2023-08-14T01:20:15
lastmod: 2023-11-10T14:52:14+08:00
draft: false
weight: 2002
---

## 便签 {#便签}

| -                                                                      |                                                              |
|------------------------------------------------------------------------|--------------------------------------------------------------|
| [环状滚动](https://blog.csdn.net/weixin_30823001/article/details/97182949) | 1. html格式                                                  |
|                                                                        | 2. css样式                                                   |
|                                                                        | 3. transform: translateX                                     |
| [多个li显示在一行](https://blog.csdn.net/asxxf/article/details/53303987) | display: inline-block                                        |
| [基础html格式+css样式](https://cloud.tencent.com/developer/article/1093726) |                                                              |
| [通过js设置css参数](https://www.cnblogs.com/LiuWeiLong/p/6058059.html) | 1. element.style.setProperty('transform', 'translateX(1px)') |
|                                                                        | 2. element.style.getPropertyValue('transform')               |
|                                                                        | 3. element.style.cssText = 'left: 10px'                      |
|                                                                        | 4. 猜测：通过js获取的css参数, 不来自css文件, 而是html代码的设置 |
| [css Position](https://www.runoob.com/css/css-positioning.html)        | 1. li标签不自动换行: absolute, fixed                         |
|                                                                        | 2. 计算绝对位置                                              |


## 样式 {#样式}

`css` <br/>

| -         |             |                        |
|-----------|-------------|------------------------|
| imageList | height      | 滚动框高度, 滚动框之间的边界 |
|           | overflow    | 向右滚动时, 溢出不触发滚动条 |
|           | perspective | 1. 滚动框左右的边界    |
|           |             | 2. 垂直滚动时, 滚动框跟随滚动 |
| li        | width       | 图片宽度               |
|           | padding     | 第一个参数: top边界, 滚动框之间的间隔 |
|           |             | 第二个参数: 嵌套时长宽边界 |
|           | position    | 1. 多个li不自动换行    |
|           |             | 2. 采用绝对位置        |
|           |             | 3. fixed或absolute都可 |
|           | display     | li显示在一行           |

```css
.imageList {
  height: 158px;
  overflow: hidden;
  perspective: 2000px;

  ul li {
    width: 200px;
    padding: 2px 2px;
    position: fixed;
    display: inline-block;

    // 去除小黑点
    // overflow: hidden;

    // 四个角圆润
    // border-radius: 5px;
  }
}
```


## 图片存放在无序列表, 使用id标识 {#图片存放在无序列表-使用id标识}

`html` <br/>
scrollpic1向右滚动, scrollpic2向左滚动 <br/>

```html
<div class="imageList" id="scrollpic1">
  <ul>
    <li><img src="1.jpg" /></li>
    <li><img src="2.jpg" /></li>
    <li><img src="3.jpg" /></li>
    <li><img src="4.jpg" /></li>
    <li><img src="5.jpg" /></li>
    <li><img src="6.jpg" /></li>
    <li><img src="1.jpg" /></li>
    <li><img src="2.jpg" /></li>
    <li><img src="3.jpg" /></li>
    <li><img src="4.jpg" /></li>
    <li><img src="5.jpg" /></li>
    <li><img src="6.jpg" /></li>
  </ul>
</div>
<div class="imageList" id="scrollpic2">
  <ul>
    <li><img src="7.jpg" /></li>
    <li><img src="8.jpg" /></li>
    <li><img src="9.jpg" /></li>
    <li><img src="10.jpg" /></li>
    <li><img src="11.jpg" /></li>
    <li><img src="12.jpg" /></li>
    <li><img src="7.jpg" /></li>
    <li><img src="8.jpg" /></li>
    <li><img src="9.jpg" /></li>
    <li><img src="10.jpg" /></li>
    <li><img src="11.jpg" /></li>
    <li><img src="12.jpg" /></li>
  </ul>
</div>
```


## 图片水平循环滚动 {#图片水平循环滚动}


### 进入判断 {#进入判断}

```javascript
document.addEventListener('DOMContentLoaded', () => {
  const pics1 = document.querySelectorAll('#scrollpic1 li');
  const pics2 = document.querySelectorAll('#scrollpic2 li');
  if (!pics1.length || !pics2.length) return;

  // 后续处理
});
```


### 图片组规格 {#图片组规格}

1.  单张图片宽度200px(ul li width) <br/>
    考虑到图片间隔: <br/>
    ```javascript
    const PicWidth = 205;
    ```
2.  一组12张图, 实际滚动框宽度: <br/>
    ```text
    205px * 12 = 2460px
    ```
3.  考虑到左右溢出和窗口宽度, 图片水平位移范围: <br/>
    ```javascript
    const FrontEnd = 2000; // > window.innerWidth
    const BackEnd = -460;
    ```


### 步长 {#步长}

```javascript
const Step = 0.2;
```


### 游标 {#游标}

|      | 范围                     |
|------|------------------------|
| 向右滚动 | 0 ~ (FrontEnd - BackEnd) |
| 向左滚动 | (BackEnd - FrontEnd) ~ 0 |


#### 定义游标 {#定义游标}

全局变量 <br/>

```javascript
let Cur1 = 0;
let Cur2 = 0;
```


#### 开启循环定时器, 更新游标 {#开启循环定时器-更新游标}

```javascript
const ScrollTimerInterval = 5;

const scrollTimer = window.setInterval(function () {
    Cur1 = (Cur1 + Step) % (FrontEnd - BackEnd); // 向右滚动
    Cur2 = (Cur2 - Step) % (FrontEnd - BackEnd); // 向左滚动
}, ScrollTimerInterval);
```


### 实现函数: 根据游标实时位置, 平移图片组成员 {#实现函数-根据游标实时位置-平移图片组成员}

`translatePic` <br/>


#### 参数 {#参数}

| -    |     |
|------|-----|
| pics | 图片组 |
| cur  | 游标 |


#### 遍历图片组 {#遍历图片组}

```javascript
function translatePic(pics, cur) {
    for (let i = 0; i < pics.length; ++i) {
        // 处理成员
    }
}
```


#### 根据成员的相对位置计算平移 {#根据成员的相对位置计算平移}

|      |         | -                                           |
|------|---------|---------------------------------------------|
| 向右滚动 | cur     | 0 ~ (FrontEnd - BackEnd)                    |
|      | 成员偏移 | 0 ~ (FrontEnd - BackEnd)                    |
|      | thisCur | 0 ~ 2 \* (FrontEnd - BackEnd)               |
| 向左滚动 | cur     | (BackEnd - FrontEnd) ~ 0                    |
|      | 成员偏移 | 0 ~ (FrontEnd - BackEnd)                    |
|      | thisCur | (BackEnd - FrontEnd) ~ (FrontEnd - BackEnd) |

<!--list-separator-->

-  控制成员平移范围

    thisCur范围应该为BackEnd ~ FrontEnd <br/>
    
    ```javascript
    let thisCur = cur + i * PicWidth;
    
    if (thisCur > FrontEnd)
        thisCur -= FrontEnd - BackEnd;
    else if (thisCur < BackEnd)
        thisCur += FrontEnd - BackEnd;
    ```

<!--list-separator-->

-  平移成员

    ```javascript
    const value = 'translateX(' + thisCur + 'px)';
    pics[i].style.setProperty('transform', value);
    ```


### 完整代码 {#完整代码}

```javascript
const PicWidth = 205;
const FrontEnd = 2000;
const BackEnd = -460;
const Step = 0.2;
const ScrollTimerInterval = 5;

function translatePic(pics, cur) {
  for (let i = 0; i < pics.length; ++i) {
    let thisCur = cur + i * PicWidth;

    if (thisCur > FrontEnd)
      thisCur -= FrontEnd - BackEnd;
    else if (thisCur < BackEnd)
      thisCur += FrontEnd - BackEnd;

    const value = 'translateX(' + thisCur + 'px)';
    pics[i].style.setProperty('transform', value);
  }
}

let Cur1 = 0;
let Cur2 = 0;
document.addEventListener('DOMContentLoaded', () => {
  const pics1 = document.querySelectorAll('#scrollpic1 li');
  const pics2 = document.querySelectorAll('#scrollpic2 li');
  if (!pics1.length || !pics2.length) return;

  const scrollTimer = window.setInterval(function () {
    Cur1 = (Cur1 + Step) % (FrontEnd - BackEnd); // 0 ~ (FrontEnd - BackEnd)
    Cur2 = (Cur2 - Step) % (FrontEnd - BackEnd); // (BackEnd - FrontEnd) ~ 0
    translatePic(pics1, Cur1);
    translatePic(pics2, Cur2);
  }, ScrollTimerInterval);
});
```

